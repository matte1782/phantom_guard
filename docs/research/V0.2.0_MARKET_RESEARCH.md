# Phantom Guard v0.2.0 — Market Research & Feature Planning

> **Date**: 2026-01-04
> **Version**: v0.2.0 Planning
> **Status**: APPROVED FOR ARCHITECT
> **Research Method**: Web search, competitor analysis, repository review
> **Sources**: 20+ authoritative sources cited

---

## Executive Summary

This document consolidates market research for Phantom Guard v0.2.0 planning. Key findings:

1. **3 direct competitors** exist in the slopsquatting detection space
2. **GitHub Action** should be prioritized over GitHub App (easier, higher ROI)
3. **VS Code extension** market has security concerns — our extension must be exemplary
4. **Detection gap** with SlopGuard on 4 signals must be closed
5. **0.08% false positive rate** is market-leading (vs 2.5% SlopGuard)

---

## Table of Contents

1. [Current State Assessment](#1-current-state-assessment)
2. [Competitive Landscape](#2-competitive-landscape)
3. [User Pain Points](#3-user-pain-points)
4. [Feature Prioritization](#4-feature-prioritization)
5. [VS Code Extension Requirements](#5-vs-code-extension-requirements)
6. [Success Metrics](#6-success-metrics)
7. [Risk Assessment](#7-risk-assessment)
8. [Sources](#8-sources)

---

## 1. Current State Assessment

### Phantom Guard v0.1.2 Capabilities

| Capability | Status | Metric |
|------------|--------|--------|
| Detection signals | 11 types | Industry-leading |
| False positive rate | 0.08% | Best in class |
| Test coverage | 99%+ | Best in class |
| Registry support | 3 (PyPI, npm, crates.io) | Complete |
| Performance (cached) | <10ms | Excellent |
| Performance (uncached) | <200ms | Excellent |
| CLI interface | Complete | Full-featured |
| Interactive showcase | Live | Differentiator |
| Documentation | Comprehensive | 627-line README |

### What We Have That Others Don't

1. **Multi-registry support** — PyPI, npm, AND crates.io
2. **Risk scoring** — 0-1 continuous scale (not binary)
3. **Interactive showcase** — Live demo at GitHub Pages
4. **99%+ test coverage** — Production-grade quality
5. **0.08% FP rate** — Best in market

### Gaps to Address

1. No IDE integration (VS Code extension)
2. No CI/CD marketplace presence (GitHub Action)
3. Missing 4 detection signals vs SlopGuard
4. No community pattern contribution system

---

## 2. Competitive Landscape

### CRITICAL: 3 Direct Competitors (Not 1)

| Competitor | Type | Threat Level | Status |
|------------|------|--------------|--------|
| **SlopGuard** | Dedicated tool | HIGH | Active |
| **antislopsquat** | OSS tool | MEDIUM | Active on GitHub |
| **Socket.dev** | Platform feature | HIGH | Has slopsquatting detection |

### 2.1 SlopGuard Analysis

**Source**: [SlopGuard Landing Page](https://aditya01933.github.io/aditya.github.io/slopguard)

| Feature | SlopGuard | Phantom Guard | Winner |
|---------|-----------|---------------|--------|
| Hallucination detection | Yes | Yes | TIE |
| Typosquatting | 92% precision | Levenshtein-based | TIE |
| **Namespace squatting** | Yes | No | SG |
| **Download inflation** | Yes | No | SG |
| **Ownership tracking** | Yes | No | SG |
| **Version spike** | Yes | No | SG |
| Multi-registry | Unknown | 3 registries | PG |
| False positive rate | 2.5% | **0.08%** | **PG** |
| Test coverage | Unknown | **99%+** | **PG** |
| Interactive demo | No | **Yes** | **PG** |

**SlopGuard Technical Architecture**:
- 3-stage lazy loading (87% Stage 1, 10% Stage 2, 3% Stage 3)
- 0-4 API calls per package (efficient)
- Trust scoring: 0-100 based on downloads (30), age (15), maintainer (15), GitHub (15), dependents (10), versions (10)

**Action Required**: Add 4 missing detection signals to match SlopGuard breadth.

### 2.2 antislopsquat Analysis

**Source**: [GitHub - antislopsquat](https://github.com/prashantpandeygit/antislopsquat)

| Feature | antislopsquat | Phantom Guard | Winner |
|---------|---------------|---------------|--------|
| Hallucination detection | Yes | Yes | TIE |
| Typo identification | Yes | Yes | TIE |
| Multi-registry | **PyPI only** | 3 registries | **PG** |
| Risk scoring | Binary (exists/not) | 0-1 continuous | **PG** |
| File support | .txt, .py, .ipynb | .txt, .json, .toml | TIE |
| Test coverage | Unknown | 99%+ | **PG** |
| Documentation | Basic README | Comprehensive | **PG** |

**Verdict**: antislopsquat is a simpler tool. We are ahead on all meaningful metrics.

### 2.3 Socket.dev Capabilities

**Source**: [Socket Blog - Slopsquatting](https://socket.dev/blog/slopsquatting-how-ai-hallucinations-are-fueling-a-new-class-of-supply-chain-attacks)

Socket has added slopsquatting detection as part of their broader supply chain platform:

- Behavioral analysis of packages
- Real-time PR integration via GitHub
- 3,658 typosquatting threats removed in one month (via TypoSmart partnership)

**Threat Level**: HIGH — Well-funded, broad platform, but slopsquatting is not their focus.

**Our Advantage**: Dedicated focus, lower barrier to entry, OSS.

### 2.4 GitHub Native Tools

**CRITICAL**: GitHub already has [Dependency Review Action](https://github.com/marketplace/actions/dependency-review):

- Scans PRs for vulnerable dependencies
- Free for all public repos
- Blocks merges on vulnerabilities

**Implication**: Our GitHub Action must provide **slopsquatting-specific** value that Dependency Review doesn't offer.

### 2.5 Competitive Summary

```
┌─────────────────────────────────────────────────────────────────┐
│                    COMPETITIVE POSITION                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  DETECTION BREADTH                                              │
│  SlopGuard ████████████████████ (6 signals)                    │
│  Phantom   ███████████████████████████████ (11 signals) ✓      │
│                                                                 │
│  FALSE POSITIVE RATE                                            │
│  SlopGuard ██████████████████████████████ (2.5%)               │
│  Phantom   █ (0.08%) ✓ BEST IN CLASS                           │
│                                                                 │
│  TEST COVERAGE                                                  │
│  SlopGuard Unknown                                              │
│  Phantom   ██████████████████████████████████████ (99%+) ✓     │
│                                                                 │
│  REGISTRY SUPPORT                                               │
│  SlopGuard Unknown (likely PyPI only)                          │
│  Phantom   ████████████████████████████████████ (3) ✓          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. User Pain Points

### 3.1 Developer Security Tool Complaints

**Source**: [Cycode - Application Security Tools](https://cycode.com/blog/top-application-security-tools/)

| Pain Point | Severity | How We Address |
|------------|----------|----------------|
| **Alert fatigue / too many alerts** | CRITICAL | Low FP rate (0.08%) |
| False positives | HIGH | Already best in class |
| Slow scans | MEDIUM | <200ms per package |
| Complex setup | MEDIUM | `pip install phantom-guard` |
| No IDE integration | HIGH | **v0.2.0: VS Code extension** |
| Tool fragmentation | MEDIUM | All-in-one for slopsquatting |

### 3.2 Socket.dev User Feedback

**Source**: [G2 Reviews](https://www.g2.com/products/socket-socket/reviews)

**Positive**:
- Fast detection of malicious packages
- Great PR integration
- Proactive customer support

**Negative**:
- Console follow-up is burdensome
- Latency issues reported
- Want tool consolidation

**Our Opportunity**: Simple, focused tool that does one thing exceptionally well.

### 3.3 Snyk Limitations

**Source**: [Oligo - Snyk Alternatives](https://www.oligo.security/academy/10-snyk-alternatives-to-consider-in-2025)

| Issue | Severity |
|-------|----------|
| Struggles with large projects | HIGH |
| Inconsistent CLI vs UI results | MEDIUM |
| Pricing concerns for mid-size teams | HIGH |
| Documentation gaps | MEDIUM |
| Slow customer support | MEDIUM |

**Our Opportunity**: OSS, consistent behavior, excellent docs.

### 3.4 Most Wanted Features (2025)

**Sources**: [Practical DevSecOps](https://www.practical-devsecops.com/software-supply-chain-security-tools/), [Aikido Security](https://www.aikido.dev/blog/top-software-supply-chain-security-tools)

| Feature | Market Demand | v0.2.0 Plan |
|---------|---------------|-------------|
| IDE integration | HIGH | VS Code extension |
| CI/CD PR comments | HIGH | GitHub Action |
| SBOM generation | HIGH | Future (v0.3.0) |
| Behavioral analysis | HIGH | Partial (metadata-based) |
| Policy enforcement | MEDIUM | Custom thresholds |
| Transitive deps | MEDIUM | Future |

---

## 4. Feature Prioritization

### 4.1 Corrected Priority Matrix

| Priority | Feature | Effort | Impact | Rationale |
|----------|---------|--------|--------|-----------|
| **P0** | GitHub Action (Marketplace) | 1 week | HIGH | Easier than App, higher reach |
| **P0** | 4 New Detection Signals | 2 weeks | HIGH | Close SlopGuard gap |
| **P1** | VS Code Extension | 3 weeks | HIGH | No slopsquatting extensions exist |
| **P2** | Enhanced pattern database | 1 week | MEDIUM | Community contributions |
| **P3** | GitHub App | 3 weeks | MEDIUM | Defer to v0.3.0 |

### 4.2 Why GitHub Action > GitHub App

| Factor | GitHub Action | GitHub App |
|--------|---------------|------------|
| Development effort | 1 week | 3-4 weeks |
| Maintenance | Low | High (webhooks) |
| User setup | Add YAML file | Install app, configure |
| Distribution | GitHub Marketplace | GitHub Marketplace |
| Reach | All repos | Requires permissions |

**Decision**: Ship `phantom-guard-action` first, defer App to v0.3.0.

### 4.3 New Detection Signals (P0)

| Signal | Description | Weight | Implementation |
|--------|-------------|--------|----------------|
| **Namespace squatting** | Verify maintainer legitimately owns namespace | 0.35 | Check `@scope` ownership |
| **Download inflation** | Detect bot-inflated download counts | 0.30 | Age vs download ratio |
| **Ownership transfer** | Track recent maintainer changes | 0.40 | Compare historical data |
| **Version spike** | Flag 5+ versions in 24h | 0.45 | Version timestamp analysis |

### 4.4 v0.2.0 Scope Summary

**Theme**: "Developer Workflow Integration"

```
v0.2.0 Feature Set
├── GitHub Action (Marketplace)     [P0] [1 week]
├── 4 New Detection Signals         [P0] [2 weeks]
│   ├── Namespace squatting
│   ├── Download inflation
│   ├── Ownership transfer
│   └── Version spike
├── VS Code Extension               [P1] [3 weeks]
│   ├── Real-time import validation
│   ├── Hover tooltips with risk
│   └── Quick fix suggestions
└── Enhanced Pattern Database       [P2] [1 week]
    └── Community contribution system
```

**Total Effort**: 7 weeks (with 20% buffer: ~8-9 weeks)

---

## 5. VS Code Extension Requirements

### 5.1 Market Security Context

**CRITICAL**: VS Code extension marketplace has security issues.

**Source**: [Wiz Research](https://www.wiz.io/blog/supply-chain-risk-in-vscode-extension-marketplaces), [The Hacker News](https://thehackernews.com/2025/10/over-100-vs-code-extensions-exposed.html)

| Statistic | Value |
|-----------|-------|
| Total extensions | ~60,000 |
| Verified publishers | Only 1,800 (3%) |
| Total installs | 3.3 billion |
| Extensions with malicious deps | 1,283 (229M installs) |
| Malicious extension growth (2025) | 4x increase (27 → 105) |

### 5.2 Our Extension Must Be Exemplary

| Requirement | Implementation |
|-------------|----------------|
| **No secrets in code** | Use VS Code SecretStorage API |
| **No network calls to unknown hosts** | Only registry APIs |
| **No shell execution** | Pure JS/TS implementation |
| **Minimal permissions** | Only file read access |
| **Open source** | Full source on GitHub |
| **Verified publisher** | Get Microsoft verification |
| **Security audit** | Document security practices |
| **No bundled deps with vulns** | npm audit clean |

### 5.3 Extension Feature Spec

```
phantom-guard-vscode
├── Features
│   ├── Real-time import validation (on save)
│   ├── Hover tooltips with risk score
│   ├── Problems panel integration
│   ├── Quick fix: "Did you mean X?"
│   └── Status bar indicator
├── Supported Files
│   ├── requirements.txt
│   ├── package.json
│   ├── Cargo.toml
│   └── pyproject.toml
├── Settings
│   ├── phantomGuard.enabled
│   ├── phantomGuard.threshold
│   └── phantomGuard.registries
└── Commands
    ├── Phantom Guard: Validate File
    ├── Phantom Guard: Clear Cache
    └── Phantom Guard: Show Report
```

---

## 6. Success Metrics

### 6.1 Adoption Targets

| Metric | 3-Month | 6-Month | 12-Month |
|--------|---------|---------|----------|
| GitHub stars | 500 | 2,000 | 5,000 |
| PyPI weekly downloads | 500 | 2,000 | 10,000 |
| VS Code extension installs | — | 1,000 | 5,000 |
| GitHub Action repo usage | 50 | 500 | 2,000 |
| Contributors | 5 | 15 | 30 |

### 6.2 Quality Targets

| Metric | Current | v0.2.0 Target |
|--------|---------|---------------|
| False positive rate | 0.08% | <0.5% |
| Test coverage | 99%+ | 99%+ |
| Performance (cached) | <10ms | <10ms |
| Performance (uncached) | <200ms | <200ms |
| Detection signals | 11 | 15 |

### 6.3 Competitive Targets

| Goal | Target Date |
|------|-------------|
| Match SlopGuard signal breadth | v0.2.0 |
| First slopsquatting VS Code extension | v0.2.0 |
| #1 in slopsquatting-specific tools | v0.3.0 |
| 10 enterprise trials | v0.3.0 |

---

## 7. Risk Assessment

### 7.1 Technical Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| VS Code API changes | LOW | MEDIUM | Pin VS Code engine version |
| Registry API rate limits | LOW | HIGH | Caching, exponential backoff |
| GitHub Action marketplace delays | LOW | LOW | Direct download fallback |
| New signal false positives | MEDIUM | HIGH | Extensive testing, configurable |

### 7.2 Market Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Socket adds dedicated slopsquatting tool | MEDIUM | HIGH | Speed to market, OSS moat |
| SlopGuard gains traction | MEDIUM | MEDIUM | Superior quality metrics |
| GitHub builds native detection | LOW | HIGH | Differentiate on depth |
| AI hallucinations decrease | LOW | LOW | Attack vector persists |

### 7.3 Execution Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| VS Code extension complexity | MEDIUM | MEDIUM | Start with MVP features |
| Scope creep | MEDIUM | MEDIUM | Strict P0/P1/P2 prioritization |
| Community contribution friction | HIGH | LOW | Clear contribution guide |

---

## 8. Sources

### Slopsquatting Research
- [Trend Micro - Slopsquatting](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/slopsquatting-when-ai-agents-hallucinate-malicious-packages)
- [Socket.dev - AI Hallucinations](https://socket.dev/blog/slopsquatting-how-ai-hallucinations-are-fueling-a-new-class-of-supply-chain-attacks)
- [FOSSA - Slopsquatting](https://fossa.com/blog/slopsquatting-ai-hallucinations-new-software-supply-chain-risk/)
- [Snyk - Mitigation Strategies](https://snyk.io/articles/slopsquatting-mitigation-strategies/)

### Competitor Analysis
- [SlopGuard](https://aditya01933.github.io/aditya.github.io/slopguard)
- [antislopsquat - GitHub](https://github.com/prashantpandeygit/antislopsquat)
- [Socket G2 Reviews](https://www.g2.com/products/socket-socket/reviews)

### User Feedback
- [Cycode - AppSec Tools](https://cycode.com/blog/top-application-security-tools/)
- [Oligo - Snyk Alternatives](https://www.oligo.security/academy/10-snyk-alternatives-to-consider-in-2025)
- [Practical DevSecOps - Supply Chain Tools](https://www.practical-devsecops.com/software-supply-chain-security-tools/)

### VS Code Security
- [Wiz Research - VS Code Supply Chain](https://www.wiz.io/blog/supply-chain-risk-in-vscode-extension-marketplaces)
- [The Hacker News - VS Code Extensions](https://thehackernews.com/2025/10/over-100-vs-code-extensions-exposed.html)
- [VS Code Extension Security Docs](https://code.visualstudio.com/docs/configure/extensions/extension-runtime-security)

### GitHub Integration
- [GitHub Dependency Review Action](https://github.com/marketplace/actions/dependency-review)
- [GitHub Dependency Review Docs](https://docs.github.com/en/code-security/supply-chain-security/understanding-your-software-supply-chain/about-dependency-review)

### Supply Chain Security Trends
- [Aikido - Top Supply Chain Tools](https://www.aikido.dev/blog/top-software-supply-chain-security-tools)
- [OWASP 2025 - Supply Chain Failures](https://owasp.org/Top10/2025/A03_2025-Software_Supply_Chain_Failures/)
- [TypoSmart Research](https://arxiv.org/html/2502.20528v1)

---

## Appendix A: GitHub Action Specification

```yaml
# .github/workflows/phantom-guard.yml
name: Phantom Guard
on: [pull_request]

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: matte1782/phantom-guard-action@v1
        with:
          files: |
            requirements.txt
            package.json
          fail-on: high-risk
          output: github-comment
```

### Action Outputs

| Output | Description |
|--------|-------------|
| `safe-count` | Number of safe packages |
| `suspicious-count` | Number of suspicious packages |
| `high-risk-count` | Number of high-risk packages |
| `report-json` | Full JSON report |

---

## Appendix B: Detection Signal Weights (v0.2.0)

| Signal | Weight | Category |
|--------|--------|----------|
| NOT_FOUND | 0.90 | Critical |
| HALLUCINATION_PATTERN | 0.30-0.85 | Pattern |
| TYPOSQUAT | 0.30-0.95 | Similarity |
| **NAMESPACE_SQUATTING** | 0.35 | NEW |
| **DOWNLOAD_INFLATION** | 0.30 | NEW |
| **OWNERSHIP_TRANSFER** | 0.40 | NEW |
| **VERSION_SPIKE** | 0.45 | NEW |
| RECENTLY_CREATED | 0.40 | Temporal |
| LOW_DOWNLOADS | 0.30 | Metadata |
| NO_REPOSITORY | 0.25 | Metadata |
| NO_MAINTAINER | 0.30 | Metadata |
| FEW_RELEASES | 0.20 | Metadata |
| SHORT_DESCRIPTION | 0.15 | Metadata |
| POPULAR_PACKAGE | -0.50 | Trust |
| LONG_HISTORY | -0.20 | Trust |

---

**Document Status**: APPROVED FOR ARCHITECT
**Next Step**: `/architect` to design v0.2.0 system architecture
**Review Date**: 2026-01-04
